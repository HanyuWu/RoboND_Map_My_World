# Udacity Nanodegree: Robotics Software Engineer

## Project 04: Map My World

<p align="center">
    3D Map generated by the database<br>
    <img src="./examples/3dmap.png" width="800" height="480" title="3D_Map"><br><br>
    Grid Map generated by the database<br>
    <img src="./examples/gridmap.png" width="800" height="480" title="Grid_Map" >
</p> 

### Directory Structure

```
.RoboND_Map_My_World Inside "catkin_ws/src" # Project 04: Map My World
├── my_robot                                # my_robot package
│   ├── launch
│   │   ├── mapping.launch                  # Launch robot mapping (without rtabmapviz)
│   │   ├── localization.launch             # Launch robot localization (with rtabmapviz)
│   │   ├── robot_description.launch
│   │   ├── world.launch                    # Launch empty world (with rtabmapviz)
│   │   └── teleop.launch                    # Launch empty world (with rtabmapviz)
│   ├── meshes
│   │   └── hokuyo.dae
│   ├── urdf
│   │   ├── my_robot.gazebo
│   │   └── my_robot.xacro
│   ├── worlds
│   │   ├── my.world                        # The world for robot mapping and localization
│   │   └── ...                             # Other worlds I created
│   ├── CMakeLists.txt
│   └── package.xml
├── teleop_twist_keyboard                   # teleop_twist_keyboard package
│   ├── CHANGELOG.rst
│   ├── CMakeLists.txt
│   ├── package.xml
│   ├── README.md
│   └── teleop_twist_keyboard.py
└── CMakeLists.txt 
```

### How to run

#### 1. First of all, clone this repo:
```
git clone https://github.com/HanyuWu/RoboND_Map_My_World
```

#### 2. Launch the robot inside the world
This can be done by launching ```world.launch``` file:
```
$ cd RoboND_Map_My_World/catkin_ws/
$ catkin_make
$ source devel/setup.bash
$ roslaunch my_robot world.launch
```

#### 3. Run teleop node
In another terminal:
```
$ cd RoboND_Map_My_World/catkin_ws/
$ source devel/setup.bash
$ roslaunch my_robot teleop.launch 
```

#### 4. Launch RTAB-Map
In another terminal:
```
$ cd RoboND_Map_My_World/catkin_ws/
$ catkin_make
$ source devel/setup.bash
$ roslaunch my_robot mapping.launch
```

#### 4. (optional) Launch Robot Localization
After we got the [rtabmap.db](https://drive.google.com/file/d/1Sbz-t-6W1qbBw0j-dzV2rVZ_518WwX5q/view?usp=sharing), 
put the db file inside [catkin_ws/outputs](./catkin_ws/outputs).
```
$ cd RoboND_Map_My_World/catkin_ws/
$ catkin_make
$ source devel/setup.bash
$ roslaunch my_robot localization.launch
```
Download the map first when doing localization.

<p align="center">
    Localization (yellow frusturm for robot)<br>
    <img src="./examples/localization.png" width="800" height="480" ><br><br>
    Robot Current Position<br>
    <img src="./examples/currentmap.png" width="800" height="480"  >
</p> 


### For reviewers
Please download the [rtabmap.db](https://drive.google.com/file/d/1Sbz-t-6W1qbBw0j-dzV2rVZ_518WwX5q/view?usp=sharing), and put it inside [catkin_ws/outputs](./catkin_ws/outputs). Then you can run **rtabmap-databaseViewer** on the database file. 

### Database Visualization

<p align="center">
    Rtab-Mapping<br>
    <img src="./examples/databaseviewer.png" width="800" height="480" ><br><br>
</p> 

When looking into the loop closures link, we can find Most of the global loop closures are very accurate based on the SURF detector/descriptor.


